{% load otree %}

{{block styles }}
    <link href="{{ static 'global/Instructions.css' }}" rel="stylesheet">
<style type="text/css">
td, th {
  text-align: center;
}

.bg-primary {
background-color: #3f51b5!important;
color: white;
}


</style>
{{ endblock }}
{{ block content }}
<div class="card bg-light instructions">
    <div class="card-body">
    <h3>
        Part 4 - Second additional Task
    </h3>
<br>
<br>
      For each time you have stated a sender has not reported the number equal to what his/her assigned estimation device has stated, please do the following:
      1) choose the the exact estimation task by indicating its number from the dropdown menu, and 2) type in which number you believe the estimation device has actually stated to the sender.
      To see which estimation task corresponds to which number and to remind yourself what the senders have stated across the 10 estimation tasks, you can find a table at the bottom.
      Note that the tasks are ordered in the same way as you have faced them in Part 3.

      {{ if mistrust_sender_1 > 0 }}
      <br>
      <br>
        <hr>
       <div align="center">
            <div class="card" style="width: 20%">
            <div class="card-header bg-primary" style="font-weight: bold">
            <b>Sender A</b>
                </div></div>
          You have stated that Sender A has not stated what the assigned estimation device has shown him/her {{ mistrust_sender_1}} times.
          Please indicate which estimation tasks those were and type in which number do you believe the estimation device has actually stated.
        <table class="table table-hover">
        <tr>
          <th scope="col">Round</th>
          <th scope="col">Actual Statement of estimation device</th>
        </tr>
          <script>
            for(var i = 1; i < js_vars.mistrust_sender_1 + 1 ; i++) {
              document.write("<tr>");
              document.write(["<td><select required class=\"Sender1\" id=\"sender_1_correction_", i, "_inround_select\" onChange=\"dis_option1()\">" +
              "<option value=>--------</option>" +
                      "<option value=1>1</option>" +
                      "<option value=2>2</option>" +
                      "<option value=3>3</option>" +
                      "<option value=4>4</option>" +
                      "<option value=5>5</option>" +
                      "<option value=6>6</option>" +
                      "<option value=7>7</option>" +
                      "<option value=8>8</option>" +
                      "<option value=9>9</option>" +
                      "<option value=10>10</option></select></td>"].join(''));
              document.write(["<input required name=\"sender_1_correction_", i, "_inround\" id=\"sender_1_correction_", i,"_inround\" type=\"hidden\">"].join(''));
              document.write(["<td><input required name=\"sender_1_correction_", i, "_actually\" id=\"sender_1_correction_", i,"_actually\"></td>"].join(''));
              document.write("</tr>");}

            $('body').on('propertychange input', 'input', function() {
            var inputVal = $(this).val();
            if( isNaN(Number(inputVal)) ) {
                  this.value = this.hasOwnProperty("oldValue") ? this.oldValue : '';
            } else {
                  this.oldValue = inputVal;
            }
            });

            function dis_option1() {
                var arraySelects = document.getElementsByClassName('Sender1');
                for (var j = 0; j < arraySelects.length; j++) {
                    for (var i = 0; i < arraySelects[j].options.length; i++) {
                        arraySelects[j].options[i].disabled = false;}}
                for (var m = 0; m < arraySelects.length; m++) {
                    var selectedOption = arraySelects[m].selectedIndex;
                    for (var k = 0; k < arraySelects.length; k++) {
                        arraySelects[k].options[selectedOption].disabled = true;}
                    update();
                }
                }
          </script>
          </table>
       </div>
      {{ endif }}


      {{ if mistrust_sender_2 > 0 }}
      <br>
      <br>
        <hr>
       <div align="center">
            <div class="card" style="width: 20%">
            <div class="card-header bg-primary" style="font-weight: bold">
            <b>Sender B</b>
                </div></div>
          You have stated that Sender B has not stated what the assigned estimation device has shown him/her {{ mistrust_sender_2}} times.
          Please indicate which estimation tasks those were and type in which number do you believe the estimation device has actually stated.
        <table class="table table-hover">
        <tr>
          <th scope="col">Round</th>
          <th scope="col">Actual Statement of estimation device</th>
        </tr>
          <script>
            for(var i = 1; i < js_vars.mistrust_sender_2 + 1 ; i++) {
              document.write("<tr>");
              document.write(["<td><select class=\"Sender2\" required id=\"sender_2_correction_", i, "_inround_select\" onchange=\"dis_option2()\">" +
              "<option value=>--------</option>" +
                      "<option value=1>1</option>" +
                      "<option value=2>2</option>" +
                      "<option value=3>3</option>" +
                      "<option value=4>4</option>" +
                      "<option value=5>5</option>" +
                      "<option value=6>6</option>" +
                      "<option value=7>7</option>" +
                      "<option value=8>8</option>" +
                      "<option value=9>9</option>" +
                      "<option value=10>10</option></select></td>"].join(''));
              document.write(["<input required name=\"sender_2_correction_", i, "_inround\" id=\"sender_2_correction_", i,"_inround\" type=\"hidden\">"].join(''));
              document.write(["<td><input required name=\"sender_2_correction_", i, "_actually\" id=\"sender_2_correction_", i,"_actually\"></td>"].join(''));
              document.write("</tr>");}

            function dis_option2() {
                var arraySelects = document.getElementsByClassName('Sender2');
                for (var j = 0; j < arraySelects.length; j++) {
                    for (var i = 0; i < arraySelects[j].options.length; i++) {
                        arraySelects[j].options[i].disabled = false;}}
                for (var m = 0; m < arraySelects.length; m++) {
                    var selectedOption = arraySelects[m].selectedIndex;
                    for (var k = 0; k < arraySelects.length; k++) {
                        arraySelects[k].options[selectedOption].disabled = true;}
                    update();
                }
                }

          </script>
          </table>
           </div>
      {{ endif }}


      {{ if mistrust_sender_3 > 0 }}
      <br>
      <br>
        <hr>
       <div align="center">
            <div class="card" style="width: 20%">
            <div class="card-header bg-primary" style="font-weight: bold">
            <b>Sender C</b>
                </div></div>
      You have stated that Sender C has not stated what the assigned estimation device has shown him/her {{ mistrust_sender_3}} times.
          Please indicate which estimation tasks those were and type in which number do you believe the estimation device has actually stated.
        <table class="table table-hover">
        <tr>
          <th scope="col">Round</th>
          <th scope="col">Actual Statement of estimation device</th>
        </tr>
          <script>
            for(var i = 1; i < js_vars.mistrust_sender_3 + 1 ; i++) {
              document.write("<tr>");
              document.write(["<td><select required class=\"Sender3\" id=\"sender_3_correction_", i, "_inround_select\" onchange=\"dis_option3(this)\">" +
              "<option value=>--------</option>" +
                      "<option value=1>1</option>" +
                      "<option value=2>2</option>" +
                      "<option value=3>3</option>" +
                      "<option value=4>4</option>" +
                      "<option value=5>5</option>" +
                      "<option value=6>6</option>" +
                      "<option value=7>7</option>" +
                      "<option value=8>8</option>" +
                      "<option value=9>9</option>" +
                      "<option value=10>10</option></select></td>"].join(''));
              document.write(["<input required name=\"sender_3_correction_", i, "_inround\" id=\"sender_3_correction_", i,"_inround\" type=\"hidden\">"].join(''));
              document.write(["<td><input required name=\"sender_3_correction_", i, "_actually\" id=\"sender_3_correction_", i,"_actually\"></td>"].join(''));
              document.write("</tr>");}

            function dis_option3(selectElement) {
                update();
                var arraySelects = document.getElementsByClassName('Sender3');
                var selectedOption = selectElement.selectedIndex;
                for (var m = 0; m < arraySelects.length; m++) {
                    if (arraySelects[m] === selectElement)
                      continue;
                    arraySelects[m].options[selectedOption].disabled = true;
                  }
                }

          </script>
          </table>
           </div>
      {{ endif }}


      {{ if mistrust_sender_4 > 0 }}
      <br>
      <br>
        <hr>
       <div align="center">
            <div class="card" style="width: 20%">
            <div class="card-header bg-warning" style="font-weight: bold">
            <b>Sender D</b>
                </div></div>
      You have stated that Sender D has not stated what the assigned estimation device has shown him/her {{ mistrust_sender_4}} times.
          Please indicate which estimation tasks those were and type in which number do you believe the estimation device has actually stated.
        <table class="table table-hover">
        <tr>
          <th scope="col">Round</th>
          <th scope="col">Actual Statement of estimation device</th>
        </tr>
          <script>
            for(var i = 1; i < js_vars.mistrust_sender_4 + 1 ; i++) {
              document.write("<tr>");
              document.write(["<td><select required class=\"Sender4\" id=\"sender_4_correction_", i, "_inround_select\" onchange=\"dis_option4()\">" +
              "<option value=>--------</option>" +
                      "<option value=1>1</option>" +
                      "<option value=2>2</option>" +
                      "<option value=3>3</option>" +
                      "<option value=4>4</option>" +
                      "<option value=5>5</option>" +
                      "<option value=6>6</option>" +
                      "<option value=7>7</option>" +
                      "<option value=8>8</option>" +
                      "<option value=9>9</option>" +
                      "<option value=10>10</option></select></td>"].join(''));
              document.write(["<input required name=\"sender_4_correction_", i, "_inround\" id=\"sender_4_correction_", i,"_inround\" type=\"hidden\">"].join(''));
              document.write(["<td><input required name=\"sender_4_correction_", i, "_actually\" id=\"sender_4_correction_", i,"_actually\"></td>"].join(''));
              document.write("</tr>");}

            function dis_option4() {
                var arraySelects = document.getElementsByClassName('Sender4');
                for (var j = 0; j < arraySelects.length; j++) {
                    for (var i = 0; i < arraySelects[j].options.length; i++) {
                        arraySelects[j].options[i].disabled = false;}}
                for (var m = 0; m < arraySelects.length; m++) {
                    var selectedOption = arraySelects[m].selectedIndex;
                    for (var k = 0; k < arraySelects.length; k++) {
                        arraySelects[k].options[selectedOption].disabled = true;}
                    update();
                    censored_options_4();
                }
                }

            function censored_options_4() {
                for(var i = 1; i < js_vars.mistrust_sender_4 + 1 ; i++) {
                    var dropdown = document.getElementById(["sender_4_correction_", i, "_inround_select"].join(""))
                    for (var m = 1; m < dropdown.length; m++) {
                        for(var j = 0; j <= js_vars.censored_signals_sender_4.length ; j++){
                            if (dropdown.options[m].value == js_vars.censored_signals_sender_4[j] + 1){
                            dropdown.options[m].disabled = true;}
                          }}
                        }}

          </script>
          </table>
           </div>
      {{ endif }}


      {{ if mistrust_sender_5 > 0 }}
      <br>
      <br>
    <hr>
       <div align="center">
            <div class="card" style="width: 20%">
            <div class="card-header bg-warning" style="font-weight: bold">
            <b>Sender E</b>
                </div></div>
      You have stated that Sender E has not stated what the assigned estimation device has shown him/her {{ mistrust_sender_5}} times.
          Please indicate which estimation tasks those were and type in which number do you believe the estimation device has actually stated.
        <table class="table table-hover">
        <tr>
          <th scope="col">Round</th>
          <th scope="col">Actual Statement of estimation device</th>
        </tr>
          <script>
            for(var i = 1; i < js_vars.mistrust_sender_5 + 1 ; i++) {
              document.write("<tr>");
              document.write(["<td><select required class=\"Sender5\" id=\"sender_5_correction_", i, "_inround_select\" onchange=\"dis_option5()\">" +
              "<option value=>--------</option>" +
                      "<option value=1>1</option>" +
                      "<option value=2>2</option>" +
                      "<option value=3>3</option>" +
                      "<option value=4>4</option>" +
                      "<option value=5>5</option>" +
                      "<option value=6>6</option>" +
                      "<option value=7>7</option>" +
                      "<option value=8>8</option>" +
                      "<option value=9>9</option>" +
                      "<option value=10>10</option></select></td>"].join(''));
              document.write(["<input required name=\"sender_5_correction_", i, "_inround\" id=\"sender_5_correction_", i,"_inround\" type=\"hidden\">"].join(''));
              document.write(["<td><input required name=\"sender_5_correction_", i, "_actually\" id=\"sender_5_correction_", i,"_actually\"></td>"].join(''));
              document.write("</tr>");}

            function dis_option5() {
                var arraySelects = document.getElementsByClassName('Sender5');
                for (var j = 0; j < arraySelects.length; j++) {
                    for (var i = 0; i < arraySelects[j].options.length; i++) {
                        arraySelects[j].options[i].disabled = false;}}
                for (var m = 0; m < arraySelects.length; m++) {
                    var selectedOption = arraySelects[m].selectedIndex;
                    for (var k = 0; k < arraySelects.length; k++) {
                        arraySelects[k].options[selectedOption].disabled = true;}
                    update();
                    censored_options_5();
                }
                }
            function censored_options_5() {
                for(var i = 1; i < js_vars.mistrust_sender_5 + 1 ; i++) {
                    var dropdown = document.getElementById(["sender_5_correction_", i, "_inround_select"].join(""))
                    for (var m = 1; m < dropdown.length; m++) {
                        for(var j = 0; j <= js_vars.censored_signals_sender_5.length ; j++){
                            if (dropdown.options[m].value == js_vars.censored_signals_sender_5[j] + 1){
                            dropdown.options[m].disabled = true;}
                          }}
                        }}


          </script>
          </table>
             </div>
      {{ endif }}

      {{ if mistrust_sender_6 > 0 }}
      <br>
      <br>
    <hr>
              <div align="center">
            <div class="card" style="width: 20%">
            <div class="card-header bg-warning" style="font-weight: bold">
            <b>Sender F</b>
                </div></div>

      You have stated that Sender F has not stated what the assigned estimation device has shown him/her {{ mistrust_sender_6}} times.
          Please indicate which estimation tasks those were and type in which number do you believe the estimation device has actually stated.
        <table class="table table-hover">
        <tr>
          <th scope="col">Round</th>
          <th scope="col">Actual Statement of estimation device</th>
        </tr>
          <script>
            for(var i = 1; i < js_vars.mistrust_sender_6 + 1 ; i++) {
              document.write("<tr>");
              document.write(["<td><select required class=\"Sender6\" id=\"sender_6_correction_", i, "_inround_select\" onchange=\"dis_option6()\">" +
              "<option value=>--------</option>" +
                      "<option value=1>1</option>" +
                      "<option value=2>2</option>" +
                      "<option value=3>3</option>" +
                      "<option value=4>4</option>" +
                      "<option value=5>5</option>" +
                      "<option value=6>6</option>" +
                      "<option value=7>7</option>" +
                      "<option value=8>8</option>" +
                      "<option value=9>9</option>" +
                      "<option value=10>10</option></select></td>"].join(''));
              document.write(["<input required name=\"sender_6_correction_", i, "_inround\" id=\"sender_6_correction_", i,"_inround\" type=\"hidden\">"].join(''));
              document.write(["<td><input required name=\"sender_6_correction_", i, "_actually\" id=\"sender_6_correction_", i,"_actually\"></td>"].join(''));
              document.write("</tr>");}

            function dis_option6() {
                var arraySelects = document.getElementsByClassName('Sender6');
                for (var j = 0; j < arraySelects.length; j++) {
                    for (var i = 0; i < arraySelects[j].options.length; i++) {
                        arraySelects[j].options[i].disabled = false;}}
                for (var m = 0; m < arraySelects.length; m++) {
                    var selectedOption = arraySelects[m].selectedIndex;
                    for (var k = 0; k < arraySelects.length; k++) {
                        arraySelects[k].options[selectedOption].disabled = true;}
                    update();
                    censored_options_6();
                }
                }

             function censored_options_6() {
                for(var i = 1; i < js_vars.mistrust_sender_6 + 1 ; i++) {
                    var dropdown = document.getElementById(["sender_6_correction_", i, "_inround_select"].join(""))
                    for (var m = 1; m < dropdown.length; m++) {
                        for(var j = 0; j <= js_vars.censored_signals_sender_6.length ; j++){
                            if (dropdown.options[m].value == js_vars.censored_signals_sender_6[j] + 1){
                            dropdown.options[m].disabled = true;}
                          }}
                        }}
          </script>
          </table>
           </div>
      {{ endif }}

      <br>
      <br>
        <br>

      <br>
When you have answered all the questions, please press “Next”.

    <br>
      <br>
<div align="center">
    {{ next_button }}
</div>
          </div>
    </div>


<div class="card bg-light instructions">
    <div class="card-body">
            <h3>
        History of Signals
    </h3>
<table class="table table-hover table-striped ">
  <thead>
    <tr>
      <th scope="col">Estimation Task</th>
      <th scope="col">Sender A</th>
      <th scope="col">Sender B</th>
      <th scope="col">Sender C</th>
      <th scope="col">Sender D</th>
      <th scope="col">Sender E</th>
      <th scope="col">Sender F</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th scope="row">1</th>
    {{ for p in signals_round_1 }}
              <td> {{ p  }}</td>
            {{ endfor }}
          </tr>
      <tr>
      <th scope="row">2</th>
    {{ for p in signals_round_2 }}
              <td> {{ p  }}</td>
            {{ endfor }}
          </tr>
        <tr>
      <th scope="row">3</th>
    {{ for p in signals_round_3 }}
              <td> {{ p  }}</td>
            {{ endfor }}
          </tr>
        <tr>
      <th scope="row">4</th>
    {{ for p in signals_round_4 }}
              <td> {{ p  }}</td>
            {{ endfor }}
          </tr>
        <tr>
      <th scope="row">5</th>
    {{ for p in signals_round_5 }}
              <td> {{ p  }}</td>
            {{ endfor }}
          </tr>
        <tr>
      <th scope="row">6</th>
    {{ for p in signals_round_6 }}
              <td> {{ p  }}</td>
            {{ endfor }}
          </tr>
 <tr>
      <th scope="row">7</th>
    {{ for p in signals_round_7 }}
              <td> {{ p  }}</td>
            {{ endfor }}
          </tr>
          <tr>
      <th scope="row">8</th>
    {{ for p in signals_round_8 }}
              <td> {{ p  }}</td>
            {{ endfor }}
          </tr>
          <tr>
      <th scope="row">9</th>
    {{ for p in signals_round_9 }}
              <td> {{ p  }}</td>
            {{ endfor }}
          </tr>
          <tr>
      <th scope="row">10</th>
    {{ for p in signals_round_10 }}
              <td> {{ p  }}</td>
            {{ endfor }}
          </tr>

  </tbody>
</table>
      <br>
    </div>
</div>

<script>
            window.onload = function(){
                censored_options_4();
                censored_options_5();
                censored_options_6();
            }

            function update() {
            let check_trust = [js_vars.mistrust_sender_1, js_vars.mistrust_sender_2,js_vars.mistrust_sender_3,
                                js_vars.mistrust_sender_4, js_vars.mistrust_sender_5, js_vars.mistrust_sender_6];
            for(var k = 0; k <= check_trust.length; ++k){
                for(var i = 1; i <= check_trust[k] ; i++) {
                  document.getElementById(["sender_", k + 1, "_correction_", i, "_inround"].join('')).value = document.getElementById(["sender_", k + 1 , "_correction_", i, "_inround_select"].join('')).value
            }}}

</script>
{% endblock %}
